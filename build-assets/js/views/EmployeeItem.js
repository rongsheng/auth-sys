define(["jquery","underscore","backbone","bootstrap","models/employee","text!templates/employee-item.html","text!templates/user-details.html","text!templates/error.html"],function(e,t,n,r,i,s,o,u){"use strict";var a=Backbone.View.extend({compile:_.template(s),compileUserDetails:_.template(o),compileError:_.template(u),tagName:"tr",emp_no:null,initialize:function(e){this.model=new i,this.id=e.id,this.root=e.root,_.bindAll(this,"fetchSuccess","fetchFailed","fetch","render")},events:{click:"fetch"},fetch:function(){this.clearError(),_.isEmpty(this.model.toJSON())?this.model.fetch({data:{id:this.emp_no},reset:!0,success:this.fetchSuccess,error:this.fetchFailed}):this.showDetails(this.model.get("data"))},fetchSuccess:function(e,t){t&&t.status=="success"?(t.data.to_date=="9999-01-01"&&(t.data.to_date="Today",this.model.set({to_date:"Today"})),this.showDetails(t.data)):this.showError("Failed to fetch user details")},fetchFailed:function(){this.showError("Failed to fetch user details, please refresh and try again.")},showError:function(t){e("#error-message").html(this.compileError({message:t}))},clearError:function(){e("#error-message").html("")},showDetails:function(t){var n=this.compileUserDetails({data:t});e("#user-details-modal").html(n),e("#user-details-modal").modal("show")},renderEmptyRow:function(){return e(this.root).append("<td class='empty-row' colspan='5'>Hmm, we can't find the person you've been looking for.</td>"),!0},render:function(t){this.emp_no=t.get("emp_no");var n=this.compile({data:t.toJSON()}),r=e(this.el).html(n);return e(this.root).append(r),!0}});return a});