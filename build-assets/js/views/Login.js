define(["jquery","underscore","backbone"],function(e){var t=Backbone.View.extend({el:"#login-form",events:{"click #login-btn":"login","focus #username-input, #password-input":"clear"},validateInputs:function(){var e=!0;if(this.$username.val()==""||this.$username.val().length>31)this.$username.parents(".form-group").addClass("has-error"),e=!1;if(this.$password.val()==""||this.$password.val().length>11)this.$password.parents(".form-group").addClass("has-error"),e=!1;return e||this.showError("Please check your username and password."),e},clear:function(t){e(t.currentTarget).parents(".form-group").removeClass("has-error")},login:function(){if(!this.validateInputs())return!1;e(this.el).removeClass("animated shake");var t=e(this.el).find("#username-input").val(),n=e(this.el).find("#password-input").val();e.ajax({url:"/api/auth_service/login",type:"POST",context:this,data:{u:t,p:n},dataType:"json",success:function(e){e&&e.status=="success"?window.location="/main":this.showError(e.reason,!0)},error:function(e){this.showError("Failed to connect to user, please try again.",!0)}})},showError:function(t,n){e("#error-message").text(t).css("visibility","visible"),typeof n!="undefined"&&n&&e(this.el).addClass("animated shake")},clearError:function(){e("#error-message").text("").css("visibility","hidden")},render:function(){return this.$username=e(this.el).find("#username-input"),this.$password=e(this.el).find("#password-input"),!0}});return t});